<html>
    <head>
        <style>
            @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@200;300;400;500;600;700;800;900;1000&family=Roboto:wght@300;400;500;700&display=swap");

*,
*::before,
*::after {
  box-sizing: border-box;
  padding: 0;
  margin: 0;
}

nav {
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  -o-user-select: none;
}

nav ul,
nav ul li {
  outline: 0;
}

nav ul li a {
  text-decoration: none;
}

body {
  font-family: "Nunito", sans-serif;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  background-image: url(https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/5baf8325-ed69-40b0-b9d2-d8c5d2bde3b0);
  background-repeat: no-repeat;
  background-size: cover;
}

/* MAIN MENU */
main {
  display: grid;
  grid-template-columns: 13% 87%;
  width: 100%;
  min-height: 670px;
  margin: 40px;
  background: rgb(254, 254, 254);
  box-shadow: 0 0.5px 0 1px rgba(255, 255, 255, 0.23) inset,
    0 1px 0 0 rgba(255, 255, 255, 0.66) inset, 0 4px 16px rgba(0, 0, 0, 0.12);
  border-radius: 15px;
  z-index: 10;
}

.main-menu {
  overflow: hidden;
  background: rgb(73, 57, 113);
  padding-top: 10px;
  border-radius: 15px 0 0 15px;
  font-family: "Roboto", sans-serif;
}

.main-menu h1 {
  display: block;
  font-size: 1.5rem;
  font-weight: 500;
  text-align: center;
  margin: 20px 0 30px;
  color: #fff;
  font-family: "Nunito", sans-serif;
}

.logo {
  display: none;
}

.nav-item {
  position: relative;
  display: block;
}

.nav-item a {
  position: relative;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-size: 1rem;
  padding: 15px 0;
  margin-left: 10px;
  border-top-left-radius: 20px;
  border-bottom-left-radius: 20px;
}

.nav-item b:nth-child(1) {
  position: absolute;
  top: -15px;
  height: 15px;
  width: 100%;
  background: #fff;
  display: none;
}

.nav-item b:nth-child(1)::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-bottom-right-radius: 20px;
  background: rgb(73, 57, 113);
}

.nav-item b:nth-child(2) {
  position: absolute;
  bottom: -15px;
  height: 15px;
  width: 100%;
  background: #fff;
  display: none;
}

.nav-item b:nth-child(2)::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-top-right-radius: 20px;
  background: rgb(73, 57, 113);
}

.nav-item.active b:nth-child(1),
.nav-item.active b:nth-child(2) {
  display: block;
}

.nav-item.active a {
  text-decoration: none;
  color: #000;
  background: rgb(254, 254, 254);
}

.nav-icon {
  width: 60px;
  height: 20px;
  font-size: 20px;
  text-align: center;
}

.nav-text {
  display: block;
  width: 120px;
  height: 20px;
}

/* CONTENT */
.content {
  display: grid;
  grid-template-columns: 75% 25%;
}

/* LEFT CONTENT */
.left-content {
  display: grid;
  grid-template-rows: 400px 300px; /* Valores fixos em pixels */
  background: #f6f7fb;
  margin: 15px;
  padding: 20px;
  border-radius: 15px;
}

/* Estilos para os gráficos */
.chart-container {
  
  height: 100%; /* Altura fixa ou use min-height */
  width: 100%;
  margin: 15px 0;
  padding: 15px;
  background: white;
  border-radius: 15px;
  box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 3px;
}

.chart-title {
  font-size: 1.3rem;
  font-weight: 700;
  color: #493971;
  margin-bottom: 15px;
}

.chart-controls {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

.chart-controls select, 
.chart-controls button {
  padding: 8px 12px;
  border-radius: 5px;
  border: 1px solid #ddd;
  background-color: white;
  font-family: "Nunito", sans-serif;
}

.chart-controls button {
  background-color: #493971;
  color: white;
  border: none;
  cursor: pointer;
  transition: background-color 0.3s;
}

.chart-controls button:hover {
  background-color: #3a2c5a;
}

/* RIGHT CONTENT */
.right-content {
  display: grid;
  grid-template-rows: 30% 70%;
  background: #f6f7fb;
  margin: 15px 15px 15px 0;
  padding: 10px 0;
  border-radius: 15px;
}

/* Atividades recentes */
.activity-card {
  background: white;
  margin: 10px;
  padding: 15px;
  border-radius: 10px;
  box-shadow: rgba(0, 0, 0, 0.1) 0px 1px 3px;
}

.activity-card h3 {
  color: #493971;
  margin-bottom: 5px;
}

.activity-card p {
  color: #666;
  font-size: 0.9rem;
}

.activity-card .activity-meta {
  display: flex;
  justify-content: space-between;
  margin-top: 10px;
  font-size: 0.8rem;
  color: #888;
}

/* Responsividade */
@media (max-width: 1500px) {
  main {
    grid-template-columns: 6% 94%;
  }
  .main-menu h1 {
    display: none;
  }
  .logo {
    display: block;
    width: 30px;
    margin: 20px auto;
  }
  .nav-text {
    display: none;
  }
  .content {
    grid-template-columns: 70% 30%;
  }
}

@media (max-width: 1310px) {
  main {
    grid-template-columns: 8% 92%;
    margin: 30px;
  }
  .content {
    grid-template-columns: 65% 35%;
  }
}

@media (max-width: 1150px) {
  .content {
    grid-template-columns: 60% 40%;
  }
  .left-content {
    grid-template-rows: 50% 50%;
  }
}

@media (max-width: 910px) {
  main {
    grid-template-columns: 10% 90%;
    margin: 20px;
  }
  .content {
    grid-template-columns: 55% 45%;
  }
}

@media (max-width: 700px) {
  main {
    grid-template-columns: 15% 85%;
  }
  .content {
    grid-template-columns: 100%;
    grid-template-rows: auto auto;
    grid-template-areas:
      "leftContent"
      "rightContent";
  }
  .left-content {
    grid-area: leftContent;
    grid-template-rows: auto auto;
  }
  .right-content {
    grid-area: rightContent;
    grid-template-rows: auto auto;
    margin: 15px;
  }
}


/* LEFT CONTENT */
.left-content {
  display: grid;
  grid-template-rows: 250px 250px; /* Alturas iguais para ambos os gráficos */
  background: #f6f7fb;
  margin: 15px;
  padding: 20px;
  border-radius: 15px;
  margin-bottom: 50px ;
  gap: 15px; /* Adicionei um gap entre os gráficos */
}

/* Estilos para os gráficos */
.chart-container {
  height: 100%; /* Usa 100% do espaço disponível */
  width: 100%;
  padding: 10px;
  background: white;
  border-radius: 15px;
  box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 3px;
  position: relative; /* Para posicionamento absoluto dos elementos internos */

  z-index: 10000; /* Impede que o conteúdo vaze */
}

.chart-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: #493971;
  margin-bottom: 10px;
}

.chart-controls {
  display: flex;
  gap: 8px;
  margin-bottom: 10px;
}

.chart-controls select, 
.chart-controls button {
  padding: 6px 10px;
  font-size: 0.9rem;
}

/* RIGHT CONTENT */
.right-content {
  display: grid;
  grid-template-rows: 250px auto;
  background: #f6f7fb;
  margin: 15px 15px 15px 0;
  padding: 10px 0;
  border-radius: 15px;
  gap: 15px; /* Adicionei um gap entre os elementos */
}



.content-ia {
  
  height: 100%; /* Altura fixa ou use min-height */
  width: 100%;
  margin: 0 auto;
  padding: 15px;;
  margin-top: 20px;
  background: rgba(218, 204, 223, 0.597);
  border-radius: 15px;
  box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 3px;
}



        </style>
    </head>

<body>
    <main>
      <nav class="main-menu">
        <h1>NPDEAS</h1>
        <img class="logo" src="https://github.com/ecemgo/mini-samples-great-tricks/assets/13468728/4cfdcb5a-0137-4457-8be1-6e7bd1f29ebb" alt="" />
        <ul>
          <li class="nav-item">
            <b></b>
            <b></b>
            <a href="home.html">
              <i class="fa fa-house nav-icon"></i>
              <span class="nav-text">Home</span>
            </a>
          </li>

          <li class="nav-item active">
            <b></b>
            <b></b>
            <a href="dashboard.html">
              <i class="fa fa-user nav-icon"></i>
              <span class="nav-text">Dashboards</span>
            </a>
          </li>

          <li class="nav-item">
            <b></b>
            <b></b>
            <a href="atividades.html">
              <i class="fa fa-calendar-check nav-icon"></i>
              <span class="nav-text">Atividades</span>
            </a>
          </li>

          <li class="nav-item">
            <b></b>
            <b></b>
            <a href="alunos.html">
              <i class="fa fa-person-running nav-icon"></i>
              <span class="nav-text">Alunos</span>
            </a>
          </li>
          <li class="nav-item">
            <b></b>
            <b></b>
            <a href="horas.html">
              <i class="fa fa-person-running nav-icon"></i>
              <span class="nav-text">Horas</span>
            </a>
          </li>

          <li class="nav-item">
            <b></b>
            <b></b>
            <a href="projetos.html">
              <i class="fa fa-person-running nav-icon"></i>
              <span class="nav-text">Projetos</span>
            </a>
          </li>
        </ul>
      </nav>

      
      <section class="content" style="height:600px; overflow-y: scroll; overflow-x: hidden;">


        <div class="left-content">

          
          <!-- Gráfico de Ranking de Alunos (que estava no right-content) -->
          <div class="chart-container" style="background-color: rgb(208, 195, 218); padding-bottom: 60px;" >
            <h2 class="chart-title">Ranking de alunos</h2>
            <canvas id="summaryChart"></canvas>
          </div>
      
          <!-- Gráfico de Horas por Projeto (mantido no left-content) -->
          <div class="chart-container" style=" overflow-y: scroll; background-color: rgb(208, 195, 218);">
            <h2 class="chart-title">Horas por Projeto</h2>
            <div class="chart-controls">
              <select id="chart-type">
                <option value="bar">Barras</option>
                <option value="pie">Pizza</option>
                <option value="line">Linhas</option>
              </select>
              <select id="time-period">
                <option value="week">Semana</option>
                <option value="month">Mês</option>
                <option value="year">Ano</option>
              </select>
              <button onclick="updateChart()">Atualizar</button>
            </div>
            <canvas id="hoursChart"></canvas>
          </div>

          

        <div class="content-ia">
          <h2>Análise resumo por IA</h2>

          <p id="resumoia"></p>
      </div>

        </div>
      
        <div class="right-content">
          <!-- Gráfico de Distribuição de Atividades (que estava no left-content) -->
          <div class="chart-container">
            <h2 class="chart-title">Distribuição de Atividades</h2>
            <canvas id="projectsChart"></canvas>
          </div>
      
          <div style="padding: 15px;">
            <h2 class="chart-title">Atividades Recentes</h2>
            <div id="recent-activities">
              <!-- Atividades serão carregadas aqui -->
            </div>
          </div>
        </div>


      </section>

    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      
      async function getiadata() {

          // URL base da API
    const API_BASE_URL = 'http://127.0.0.1:5000';

            // Carrega todos os dados do endpoint de resumo
      const response = await fetch(`${API_BASE_URL}/resumoia`);

      

            

        const r =  document.getElementById('resumoia') 
        r.innerHTML = ''
      }
    // Variáveis para os gráficos
    let hoursChart, projectsChart, summaryChart;
    
    // Cores para os gráficos
    const chartColors = [
        '#493971', '#6a4c93', '#8f6eb5', '#b392d0',
        '#d6bae8', '#a541be', '#7d2a9f', '#590b94'
    ];
    
    // URL base da API
    const API_BASE_URL = 'http://127.0.0.1:5000';
    
    // Função principal para carregar os dados
    async function loadCharts() {
        try {
            // Carrega todos os dados do endpoint de resumo
            const response = await fetch(`${API_BASE_URL}/dashboard/resumo`);
            
            if (!response.ok) {
                throw new Error('Erro ao carregar dados');
            }
            
            const data = await response.json();
            
            // Renderiza os gráficos com os dados reais
            renderHoursChart(data.horasPorProjeto);
            renderProjectsDistribution(data.distribuicaoAtividades);
            renderStudentsRanking(data.rankingAlunos);
            renderRecentActivities(data.atividadesRecentes);
            
        } catch (error) {
            console.error('Erro ao carregar dados:', error);
            showError('Falha ao carregar dados. Tente recarregar a página.');
        }
    }
    
    // Função para renderizar o gráfico de horas por projeto
    function renderHoursChart(data) {
        const ctx = document.getElementById('hoursChart').getContext('2d');
        
        if (hoursChart) {
            hoursChart.destroy();
        }
        
        const chartType = document.getElementById('chart-type').value;
        
        hoursChart = new Chart(ctx, {
            type: chartType,
            data: {
                labels: data.map(item => item.nome),
                datasets: [{
                    label: 'Horas Trabalhadas',
                    data: data.map(item => item.horas),
                    backgroundColor: chartColors,
                    borderColor: '#ffffff',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: chartType === 'pie' ? 'right' : 'top',
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return `${context.dataset.label}: ${context.raw} horas`;
                            }
                        }
                    }
                },
                scales: chartType === 'pie' || chartType === 'doughnut' ? {} : {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Horas'
                        }
                    }
                }
            }
        });
    }
    
    // Função para renderizar a distribuição de atividades
    function renderProjectsDistribution(data) {
        const ctx = document.getElementById('projectsChart').getContext('2d');
        
        if (projectsChart) {
            projectsChart.destroy();
        }
        
        // Transforma o objeto em array para o Chart.js
        const labels = Object.keys(data);
        const values = Object.values(data);
        
        projectsChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [{
                    data: values,
                    backgroundColor: ['#4CAF50', '#FFC107', '#F44336'],
                    borderColor: '#ffffff',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                const value = context.raw;
                                const percentage = Math.round((value / total) * 100);
                                return `${context.label}: ${value} (${percentage}%)`;
                            }
                        }
                    }
                }
            }
        });
    }
    
    // Função para renderizar o ranking de alunos
    function renderStudentsRanking(data) {
        const ctx = document.getElementById('summaryChart').getContext('2d');
        
        if (summaryChart) {
            summaryChart.destroy();
        }
        
        summaryChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: data.map(item => item.nome),
                datasets: [{
                    label: 'Horas Trabalhadas',
                    data: data.map(item => item.horas),
                    backgroundColor: chartColors,
                    borderColor: '#ffffff',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            afterBody: function(context) {
                                const index = context[0].dataIndex;
                                return `Setor: ${data[index].setor}`;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Horas'
                        }
                    }
                }
            }
        });
    }
    
    // Função para renderizar atividades recentes
    function renderRecentActivities(activities) {
        const container = document.getElementById('recent-activities');
        container.innerHTML = '';
        
        if (activities.length === 0) {
            container.innerHTML = '<p class="no-activities">Nenhuma atividade recente encontrada</p>';
            return;
        }
        
        activities.forEach(activity => {
            const activityDate = new Date(activity.data).toLocaleDateString('pt-BR');
            const alunosList = activity.alunos.join(', ');
            
            const activityElement = document.createElement('div');
            activityElement.className = 'activity-card';
            activityElement.innerHTML = `
                <h3>${activity.nome}</h3>
                <p>${activity.descricao}</p>
                <div class="activity-meta">
                    <span><strong>Projeto:</strong> ${activity.projeto}</span>
                    <span><strong>Horas:</strong> ${activity.horas}h</span>
                    <span><strong>Data:</strong> ${activityDate}</span>
                </div>
                <div class="activity-alunos">
                    <strong>Alunos:</strong> ${alunosList}
                </div>
            `;
            container.appendChild(activityElement);
        });
    }
    
    // Função para mostrar erros
    function showError(message) {
        const container = document.querySelector('.left-content');
        const errorElement = document.createElement('div');
        errorElement.className = 'error-message';
        errorElement.innerHTML = `
            <p>${message}</p>
            <button onclick="loadCharts()">Tentar novamente</button>
        `;
        container.prepend(errorElement);
    }
    
    // Função para atualizar o gráfico com filtros
    async function updateChart() {
        const timePeriod = document.getElementById('time-period').value;
        const chartType = document.getElementById('chart-type').value;
        
        try {
            // Carrega dados com filtro de período (implemente no backend)
            const response = await fetch(`${API_BASE_URL}/dashboard/horas-por-projeto?periodo=${timePeriod}`);
            
            if (!response.ok) {
                throw new Error('Erro ao filtrar dados');
            }
            
            const data = await response.json();
            
            // Atualiza apenas o gráfico de horas
            renderHoursChart(data);
            
            // Atualiza o tipo do gráfico
            if (hoursChart) {
                hoursChart.config.type = chartType;
                hoursChart.update();
            }
            
        } catch (error) {
            console.error('Erro ao filtrar dados:', error);
            alert('Não foi possível aplicar os filtros. Tente novamente.');
        }
    }
    
    // Inicializar os gráficos quando a página carregar
    document.addEventListener('DOMContentLoaded', loadCharts);
    
    // Manipulação dos itens do menu
    const navItems = document.querySelectorAll(".nav-item");
    navItems.forEach((navItem, i) => {
        navItem.addEventListener("click", () => {
            navItems.forEach((item, j) => {
                item.className = "nav-item";
            });
            navItem.className = "nav-item active";
        });
    });
    </script>
</body>
</html>



 


